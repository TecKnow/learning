from datetime import datetime
import json
import os
from pathlib import Path
from urllib.request import urlretrieve
from itertools import product
from calendar import Calendar

import pytest

from zodiac import (get_signs, get_sign_with_most_famous_people,
                    signs_are_mutually_compatible, get_sign_by_date)

# original source: https://zodiacal.herokuapp.com/api
URL = "https://bites-data.s3.us-east-2.amazonaws.com/zodiac.json"
TMP = os.getenv("TMP", "/tmp")
PATH = Path(TMP, "zodiac.json")


@pytest.fixture(scope='module')
def signs():
    if not PATH.exists():
        urlretrieve(URL, PATH)
    with open(PATH) as f:
        data = json.loads(f.read())
    return get_signs(data)

# write your pytest code here ...

def test_sign_data(signs):
    for sign in signs:
        assert type(sign).__name__=="Sign"

def test_sign_names(signs):
    expected_sign_names = ['Aries', 'Taurus', 'Gemini', 'Cancer', 'Leo', 'Virgo',
                           'Libra', 'Scorpio', 'Sagittarius', 'Capricorn', 'Aquarius', 'Pisces']
    found_sign_names = [sign.name for sign in signs]
    assert found_sign_names == expected_sign_names


def test_sign_compatibility(signs):
    expected_compat = {('Aquarius', 'Aquarius', False),
                       ('Aquarius', 'Aries', True),
                       ('Aquarius', 'Cancer', False),
                       ('Aquarius', 'Capricorn', False),
                       ('Aquarius', 'Gemini', False),
                       ('Aquarius', 'Leo', False),
                       ('Aquarius', 'Libra', False),
                       ('Aquarius', 'Pisces', False),
                       ('Aquarius', 'Sagittarius', False),
                       ('Aquarius', 'Scorpio', False),
                       ('Aquarius', 'Taurus', False),
                       ('Aquarius', 'Virgo', False),
                       ('Aries', 'Aquarius', True),
                       ('Aries', 'Aries', False),
                       ('Aries', 'Cancer', False),
                       ('Aries', 'Capricorn', False),
                       ('Aries', 'Gemini', True),
                       ('Aries', 'Leo', True),
                       ('Aries', 'Libra', False),
                       ('Aries', 'Pisces', False),
                       ('Aries', 'Sagittarius', True),
                       ('Aries', 'Scorpio', False),
                       ('Aries', 'Taurus', False),
                       ('Aries', 'Virgo', False),
                       ('Cancer', 'Aquarius', False),
                       ('Cancer', 'Aries', False),
                       ('Cancer', 'Cancer', False),
                       ('Cancer', 'Capricorn', False),
                       ('Cancer', 'Gemini', False),
                       ('Cancer', 'Leo', False),
                       ('Cancer', 'Libra', False),
                       ('Cancer', 'Pisces', False),
                       ('Cancer', 'Sagittarius', False),
                       ('Cancer', 'Scorpio', True),
                       ('Cancer', 'Taurus', True),
                       ('Cancer', 'Virgo', False),
                       ('Capricorn', 'Aquarius', False),
                       ('Capricorn', 'Aries', False),
                       ('Capricorn', 'Cancer', False),
                       ('Capricorn', 'Capricorn', False),
                       ('Capricorn', 'Gemini', False),
                       ('Capricorn', 'Leo', False),
                       ('Capricorn', 'Libra', False),
                       ('Capricorn', 'Pisces', False),
                       ('Capricorn', 'Sagittarius', False),
                       ('Capricorn', 'Scorpio', False),
                       ('Capricorn', 'Taurus', True),
                       ('Capricorn', 'Virgo', False),
                       ('Gemini', 'Aquarius', False),
                       ('Gemini', 'Aries', True),
                       ('Gemini', 'Cancer', False),
                       ('Gemini', 'Capricorn', False),
                       ('Gemini', 'Gemini', False),
                       ('Gemini', 'Leo', False),
                       ('Gemini', 'Libra', True),
                       ('Gemini', 'Pisces', False),
                       ('Gemini', 'Sagittarius', False),
                       ('Gemini', 'Scorpio', False),
                       ('Gemini', 'Taurus', False),
                       ('Gemini', 'Virgo', False),
                       ('Leo', 'Aquarius', False),
                       ('Leo', 'Aries', True),
                       ('Leo', 'Cancer', False),
                       ('Leo', 'Capricorn', False),
                       ('Leo', 'Gemini', False),
                       ('Leo', 'Leo', False),
                       ('Leo', 'Libra', False),
                       ('Leo', 'Pisces', False),
                       ('Leo', 'Sagittarius', False),
                       ('Leo', 'Scorpio', False),
                       ('Leo', 'Taurus', False),
                       ('Leo', 'Virgo', False),
                       ('Libra', 'Aquarius', False),
                       ('Libra', 'Aries', False),
                       ('Libra', 'Cancer', False),
                       ('Libra', 'Capricorn', False),
                       ('Libra', 'Gemini', True),
                       ('Libra', 'Leo', False),
                       ('Libra', 'Libra', False),
                       ('Libra', 'Pisces', False),
                       ('Libra', 'Sagittarius', False),
                       ('Libra', 'Scorpio', False),
                       ('Libra', 'Taurus', False),
                       ('Libra', 'Virgo', False),
                       ('Pisces', 'Aquarius', False),
                       ('Pisces', 'Aries', False),
                       ('Pisces', 'Cancer', False),
                       ('Pisces', 'Capricorn', False),
                       ('Pisces', 'Gemini', False),
                       ('Pisces', 'Leo', False),
                       ('Pisces', 'Libra', False),
                       ('Pisces', 'Pisces', False),
                       ('Pisces', 'Sagittarius', False),
                       ('Pisces', 'Scorpio', False),
                       ('Pisces', 'Taurus', True),
                       ('Pisces', 'Virgo', False),
                       ('Sagittarius', 'Aquarius', False),
                       ('Sagittarius', 'Aries', True),
                       ('Sagittarius', 'Cancer', False),
                       ('Sagittarius', 'Capricorn', False),
                       ('Sagittarius', 'Gemini', False),
                       ('Sagittarius', 'Leo', False),
                       ('Sagittarius', 'Libra', False),
                       ('Sagittarius', 'Pisces', False),
                       ('Sagittarius', 'Sagittarius', False),
                       ('Sagittarius', 'Scorpio', False),
                       ('Sagittarius', 'Taurus', False),
                       ('Sagittarius', 'Virgo', False),
                       ('Scorpio', 'Aquarius', False),
                       ('Scorpio', 'Aries', False),
                       ('Scorpio', 'Cancer', True),
                       ('Scorpio', 'Capricorn', False),
                       ('Scorpio', 'Gemini', False),
                       ('Scorpio', 'Leo', False),
                       ('Scorpio', 'Libra', False),
                       ('Scorpio', 'Pisces', False),
                       ('Scorpio', 'Sagittarius', False),
                       ('Scorpio', 'Scorpio', False),
                       ('Scorpio', 'Taurus', False),
                       ('Scorpio', 'Virgo', False),
                       ('Taurus', 'Aquarius', False),
                       ('Taurus', 'Aries', False),
                       ('Taurus', 'Cancer', True),
                       ('Taurus', 'Capricorn', True),
                       ('Taurus', 'Gemini', False),
                       ('Taurus', 'Leo', False),
                       ('Taurus', 'Libra', False),
                       ('Taurus', 'Pisces', True),
                       ('Taurus', 'Sagittarius', False),
                       ('Taurus', 'Scorpio', False),
                       ('Taurus', 'Taurus', False),
                       ('Taurus', 'Virgo', True),
                       ('Virgo', 'Aquarius', False),
                       ('Virgo', 'Aries', False),
                       ('Virgo', 'Cancer', False),
                       ('Virgo', 'Capricorn', False),
                       ('Virgo', 'Gemini', False),
                       ('Virgo', 'Leo', False),
                       ('Virgo', 'Libra', False),
                       ('Virgo', 'Pisces', False),
                       ('Virgo', 'Sagittarius', False),
                       ('Virgo', 'Scorpio', False),
                       ('Virgo', 'Taurus', True),
                       ('Virgo', 'Virgo', False)}
    sign_names = {sign.name for sign in signs}
    found_compat = {(a, b, signs_are_mutually_compatible(signs, a, b))
           for a, b in product(sign_names, repeat=2)}
    assert found_compat == expected_compat

def test_most_famous(signs):
    expected_sign = ("Scorpio", 35)
    found_sign = get_sign_with_most_famous_people(signs)
    assert found_sign == expected_sign

def test_by_date(signs):
    sun_cal = Calendar(6)
    expected_signs = [(2000, 1, 1, 'Capricorn'),
 (2000, 1, 2, 'Capricorn'),
 (2000, 1, 3, 'Capricorn'),
 (2000, 1, 4, 'Capricorn'),
 (2000, 1, 5, 'Capricorn'),
 (2000, 1, 6, 'Capricorn'),
 (2000, 1, 7, 'Capricorn'),
 (2000, 1, 8, 'Capricorn'),
 (2000, 1, 9, 'Capricorn'),
 (2000, 1, 10, 'Capricorn'),
 (2000, 1, 11, 'Capricorn'),
 (2000, 1, 12, 'Capricorn'),
 (2000, 1, 13, 'Capricorn'),
 (2000, 1, 14, 'Capricorn'),
 (2000, 1, 15, 'Capricorn'),
 (2000, 1, 16, 'Capricorn'),
 (2000, 1, 17, 'Capricorn'),
 (2000, 1, 18, 'Capricorn'),
 (2000, 1, 19, 'Capricorn'),
 (2000, 1, 20, 'Aquarius'),
 (2000, 1, 21, 'Aquarius'),
 (2000, 1, 22, 'Aquarius'),
 (2000, 1, 23, 'Aquarius'),
 (2000, 1, 24, 'Aquarius'),
 (2000, 1, 25, 'Aquarius'),
 (2000, 1, 26, 'Aquarius'),
 (2000, 1, 27, 'Aquarius'),
 (2000, 1, 28, 'Aquarius'),
 (2000, 1, 29, 'Aquarius'),
 (2000, 1, 30, 'Aquarius'),
 (2000, 1, 31, 'Aquarius'),
 (2000, 2, 1, 'Aquarius'),
 (2000, 2, 2, 'Aquarius'),
 (2000, 2, 3, 'Aquarius'),
 (2000, 2, 4, 'Aquarius'),
 (2000, 2, 5, 'Aquarius'),
 (2000, 2, 6, 'Aquarius'),
 (2000, 2, 7, 'Aquarius'),
 (2000, 2, 8, 'Aquarius'),
 (2000, 2, 9, 'Aquarius'),
 (2000, 2, 10, 'Aquarius'),
 (2000, 2, 11, 'Aquarius'),
 (2000, 2, 12, 'Aquarius'),
 (2000, 2, 13, 'Aquarius'),
 (2000, 2, 14, 'Aquarius'),
 (2000, 2, 15, 'Aquarius'),
 (2000, 2, 16, 'Aquarius'),
 (2000, 2, 17, 'Aquarius'),
 (2000, 2, 18, 'Aquarius'),
 (2000, 2, 19, 'Pisces'),
 (2000, 2, 20, 'Pisces'),
 (2000, 2, 21, 'Pisces'),
 (2000, 2, 22, 'Pisces'),
 (2000, 2, 23, 'Pisces'),
 (2000, 2, 24, 'Pisces'),
 (2000, 2, 25, 'Pisces'),
 (2000, 2, 26, 'Pisces'),
 (2000, 2, 27, 'Pisces'),
 (2000, 2, 28, 'Pisces'),
 (2000, 2, 29, 'Pisces'),
 (2000, 3, 1, 'Pisces'),
 (2000, 3, 2, 'Pisces'),
 (2000, 3, 3, 'Pisces'),
 (2000, 3, 4, 'Pisces'),
 (2000, 3, 5, 'Pisces'),
 (2000, 3, 6, 'Pisces'),
 (2000, 3, 7, 'Pisces'),
 (2000, 3, 8, 'Pisces'),
 (2000, 3, 9, 'Pisces'),
 (2000, 3, 10, 'Pisces'),
 (2000, 3, 11, 'Pisces'),
 (2000, 3, 12, 'Pisces'),
 (2000, 3, 13, 'Pisces'),
 (2000, 3, 14, 'Pisces'),
 (2000, 3, 15, 'Pisces'),
 (2000, 3, 16, 'Pisces'),
 (2000, 3, 17, 'Pisces'),
 (2000, 3, 18, 'Pisces'),
 (2000, 3, 19, 'Pisces'),
 (2000, 3, 20, 'Pisces'),
 (2000, 3, 21, 'Aries'),
 (2000, 3, 22, 'Aries'),
 (2000, 3, 23, 'Aries'),
 (2000, 3, 24, 'Aries'),
 (2000, 3, 25, 'Aries'),
 (2000, 3, 26, 'Aries'),
 (2000, 3, 27, 'Aries'),
 (2000, 3, 28, 'Aries'),
 (2000, 3, 29, 'Aries'),
 (2000, 3, 30, 'Aries'),
 (2000, 3, 31, 'Aries'),
 (2000, 4, 1, 'Aries'),
 (2000, 4, 2, 'Aries'),
 (2000, 4, 3, 'Aries'),
 (2000, 4, 4, 'Aries'),
 (2000, 4, 5, 'Aries'),
 (2000, 4, 6, 'Aries'),
 (2000, 4, 7, 'Aries'),
 (2000, 4, 8, 'Aries'),
 (2000, 4, 9, 'Aries'),
 (2000, 4, 10, 'Aries'),
 (2000, 4, 11, 'Aries'),
 (2000, 4, 12, 'Aries'),
 (2000, 4, 13, 'Aries'),
 (2000, 4, 14, 'Aries'),
 (2000, 4, 15, 'Aries'),
 (2000, 4, 16, 'Aries'),
 (2000, 4, 17, 'Aries'),
 (2000, 4, 18, 'Aries'),
 (2000, 4, 19, 'Aries'),
 (2000, 4, 20, 'Taurus'),
 (2000, 4, 21, 'Taurus'),
 (2000, 4, 22, 'Taurus'),
 (2000, 4, 23, 'Taurus'),
 (2000, 4, 24, 'Taurus'),
 (2000, 4, 25, 'Taurus'),
 (2000, 4, 26, 'Taurus'),
 (2000, 4, 27, 'Taurus'),
 (2000, 4, 28, 'Taurus'),
 (2000, 4, 29, 'Taurus'),
 (2000, 4, 30, 'Taurus'),
 (2000, 5, 1, 'Taurus'),
 (2000, 5, 2, 'Taurus'),
 (2000, 5, 3, 'Taurus'),
 (2000, 5, 4, 'Taurus'),
 (2000, 5, 5, 'Taurus'),
 (2000, 5, 6, 'Taurus'),
 (2000, 5, 7, 'Taurus'),
 (2000, 5, 8, 'Taurus'),
 (2000, 5, 9, 'Taurus'),
 (2000, 5, 10, 'Taurus'),
 (2000, 5, 11, 'Taurus'),
 (2000, 5, 12, 'Taurus'),
 (2000, 5, 13, 'Taurus'),
 (2000, 5, 14, 'Taurus'),
 (2000, 5, 15, 'Taurus'),
 (2000, 5, 16, 'Taurus'),
 (2000, 5, 17, 'Taurus'),
 (2000, 5, 18, 'Taurus'),
 (2000, 5, 19, 'Taurus'),
 (2000, 5, 20, 'Taurus'),
 (2000, 5, 21, 'Gemini'),
 (2000, 5, 22, 'Gemini'),
 (2000, 5, 23, 'Gemini'),
 (2000, 5, 24, 'Gemini'),
 (2000, 5, 25, 'Gemini'),
 (2000, 5, 26, 'Gemini'),
 (2000, 5, 27, 'Gemini'),
 (2000, 5, 28, 'Gemini'),
 (2000, 5, 29, 'Gemini'),
 (2000, 5, 30, 'Gemini'),
 (2000, 5, 31, 'Gemini'),
 (2000, 6, 1, 'Gemini'),
 (2000, 6, 2, 'Gemini'),
 (2000, 6, 3, 'Gemini'),
 (2000, 6, 4, 'Gemini'),
 (2000, 6, 5, 'Gemini'),
 (2000, 6, 6, 'Gemini'),
 (2000, 6, 7, 'Gemini'),
 (2000, 6, 8, 'Gemini'),
 (2000, 6, 9, 'Gemini'),
 (2000, 6, 10, 'Gemini'),
 (2000, 6, 11, 'Gemini'),
 (2000, 6, 12, 'Gemini'),
 (2000, 6, 13, 'Gemini'),
 (2000, 6, 14, 'Gemini'),
 (2000, 6, 15, 'Gemini'),
 (2000, 6, 16, 'Gemini'),
 (2000, 6, 17, 'Gemini'),
 (2000, 6, 18, 'Gemini'),
 (2000, 6, 19, 'Gemini'),
 (2000, 6, 20, 'Gemini'),
 (2000, 6, 21, 'Cancer'),
 (2000, 6, 22, 'Cancer'),
 (2000, 6, 23, 'Cancer'),
 (2000, 6, 24, 'Cancer'),
 (2000, 6, 25, 'Cancer'),
 (2000, 6, 26, 'Cancer'),
 (2000, 6, 27, 'Cancer'),
 (2000, 6, 28, 'Cancer'),
 (2000, 6, 29, 'Cancer'),
 (2000, 6, 30, 'Cancer'),
 (2000, 7, 1, 'Cancer'),
 (2000, 7, 2, 'Cancer'),
 (2000, 7, 3, 'Cancer'),
 (2000, 7, 4, 'Cancer'),
 (2000, 7, 5, 'Cancer'),
 (2000, 7, 6, 'Cancer'),
 (2000, 7, 7, 'Cancer'),
 (2000, 7, 8, 'Cancer'),
 (2000, 7, 9, 'Cancer'),
 (2000, 7, 10, 'Cancer'),
 (2000, 7, 11, 'Cancer'),
 (2000, 7, 12, 'Cancer'),
 (2000, 7, 13, 'Cancer'),
 (2000, 7, 14, 'Cancer'),
 (2000, 7, 15, 'Cancer'),
 (2000, 7, 16, 'Cancer'),
 (2000, 7, 17, 'Cancer'),
 (2000, 7, 18, 'Cancer'),
 (2000, 7, 19, 'Cancer'),
 (2000, 7, 20, 'Cancer'),
 (2000, 7, 21, 'Cancer'),
 (2000, 7, 22, 'Cancer'),
 (2000, 7, 23, 'Leo'),
 (2000, 7, 24, 'Leo'),
 (2000, 7, 25, 'Leo'),
 (2000, 7, 26, 'Leo'),
 (2000, 7, 27, 'Leo'),
 (2000, 7, 28, 'Leo'),
 (2000, 7, 29, 'Leo'),
 (2000, 7, 30, 'Leo'),
 (2000, 7, 31, 'Leo'),
 (2000, 8, 1, 'Leo'),
 (2000, 8, 2, 'Leo'),
 (2000, 8, 3, 'Leo'),
 (2000, 8, 4, 'Leo'),
 (2000, 8, 5, 'Leo'),
 (2000, 8, 6, 'Leo'),
 (2000, 8, 7, 'Leo'),
 (2000, 8, 8, 'Leo'),
 (2000, 8, 9, 'Leo'),
 (2000, 8, 10, 'Leo'),
 (2000, 8, 11, 'Leo'),
 (2000, 8, 12, 'Leo'),
 (2000, 8, 13, 'Leo'),
 (2000, 8, 14, 'Leo'),
 (2000, 8, 15, 'Leo'),
 (2000, 8, 16, 'Leo'),
 (2000, 8, 17, 'Leo'),
 (2000, 8, 18, 'Leo'),
 (2000, 8, 19, 'Leo'),
 (2000, 8, 20, 'Leo'),
 (2000, 8, 21, 'Leo'),
 (2000, 8, 22, 'Leo'),
 (2000, 8, 23, 'Virgo'),
 (2000, 8, 24, 'Virgo'),
 (2000, 8, 25, 'Virgo'),
 (2000, 8, 26, 'Virgo'),
 (2000, 8, 27, 'Virgo'),
 (2000, 8, 28, 'Virgo'),
 (2000, 8, 29, 'Virgo'),
 (2000, 8, 30, 'Virgo'),
 (2000, 8, 31, 'Virgo'),
 (2000, 9, 1, 'Virgo'),
 (2000, 9, 2, 'Virgo'),
 (2000, 9, 3, 'Virgo'),
 (2000, 9, 4, 'Virgo'),
 (2000, 9, 5, 'Virgo'),
 (2000, 9, 6, 'Virgo'),
 (2000, 9, 7, 'Virgo'),
 (2000, 9, 8, 'Virgo'),
 (2000, 9, 9, 'Virgo'),
 (2000, 9, 10, 'Virgo'),
 (2000, 9, 11, 'Virgo'),
 (2000, 9, 12, 'Virgo'),
 (2000, 9, 13, 'Virgo'),
 (2000, 9, 14, 'Virgo'),
 (2000, 9, 15, 'Virgo'),
 (2000, 9, 16, 'Virgo'),
 (2000, 9, 17, 'Virgo'),
 (2000, 9, 18, 'Virgo'),
 (2000, 9, 19, 'Virgo'),
 (2000, 9, 20, 'Virgo'),
 (2000, 9, 21, 'Virgo'),
 (2000, 9, 22, 'Virgo'),
 (2000, 9, 23, 'Libra'),
 (2000, 9, 24, 'Libra'),
 (2000, 9, 25, 'Libra'),
 (2000, 9, 26, 'Libra'),
 (2000, 9, 27, 'Libra'),
 (2000, 9, 28, 'Libra'),
 (2000, 9, 29, 'Libra'),
 (2000, 9, 30, 'Libra'),
 (2000, 10, 1, 'Libra'),
 (2000, 10, 2, 'Libra'),
 (2000, 10, 3, 'Libra'),
 (2000, 10, 4, 'Libra'),
 (2000, 10, 5, 'Libra'),
 (2000, 10, 6, 'Libra'),
 (2000, 10, 7, 'Libra'),
 (2000, 10, 8, 'Libra'),
 (2000, 10, 9, 'Libra'),
 (2000, 10, 10, 'Libra'),
 (2000, 10, 11, 'Libra'),
 (2000, 10, 12, 'Libra'),
 (2000, 10, 13, 'Libra'),
 (2000, 10, 14, 'Libra'),
 (2000, 10, 15, 'Libra'),
 (2000, 10, 16, 'Libra'),
 (2000, 10, 17, 'Libra'),
 (2000, 10, 18, 'Libra'),
 (2000, 10, 19, 'Libra'),
 (2000, 10, 20, 'Libra'),
 (2000, 10, 21, 'Libra'),
 (2000, 10, 22, 'Libra'),
 (2000, 10, 23, 'Scorpio'),
 (2000, 10, 24, 'Scorpio'),
 (2000, 10, 25, 'Scorpio'),
 (2000, 10, 26, 'Scorpio'),
 (2000, 10, 27, 'Scorpio'),
 (2000, 10, 28, 'Scorpio'),
 (2000, 10, 29, 'Scorpio'),
 (2000, 10, 30, 'Scorpio'),
 (2000, 10, 31, 'Scorpio'),
 (2000, 11, 1, 'Scorpio'),
 (2000, 11, 2, 'Scorpio'),
 (2000, 11, 3, 'Scorpio'),
 (2000, 11, 4, 'Scorpio'),
 (2000, 11, 5, 'Scorpio'),
 (2000, 11, 6, 'Scorpio'),
 (2000, 11, 7, 'Scorpio'),
 (2000, 11, 8, 'Scorpio'),
 (2000, 11, 9, 'Scorpio'),
 (2000, 11, 10, 'Scorpio'),
 (2000, 11, 11, 'Scorpio'),
 (2000, 11, 12, 'Scorpio'),
 (2000, 11, 13, 'Scorpio'),
 (2000, 11, 14, 'Scorpio'),
 (2000, 11, 15, 'Scorpio'),
 (2000, 11, 16, 'Scorpio'),
 (2000, 11, 17, 'Scorpio'),
 (2000, 11, 18, 'Scorpio'),
 (2000, 11, 19, 'Scorpio'),
 (2000, 11, 20, 'Scorpio'),
 (2000, 11, 21, 'Scorpio'),
 (2000, 11, 22, 'Sagittarius'),
 (2000, 11, 23, 'Sagittarius'),
 (2000, 11, 24, 'Sagittarius'),
 (2000, 11, 25, 'Sagittarius'),
 (2000, 11, 26, 'Sagittarius'),
 (2000, 11, 27, 'Sagittarius'),
 (2000, 11, 28, 'Sagittarius'),
 (2000, 11, 29, 'Sagittarius'),
 (2000, 11, 30, 'Sagittarius'),
 (2000, 12, 1, 'Sagittarius'),
 (2000, 12, 2, 'Sagittarius'),
 (2000, 12, 3, 'Sagittarius'),
 (2000, 12, 4, 'Sagittarius'),
 (2000, 12, 5, 'Sagittarius'),
 (2000, 12, 6, 'Sagittarius'),
 (2000, 12, 7, 'Sagittarius'),
 (2000, 12, 8, 'Sagittarius'),
 (2000, 12, 9, 'Sagittarius'),
 (2000, 12, 10, 'Sagittarius'),
 (2000, 12, 11, 'Sagittarius'),
 (2000, 12, 12, 'Sagittarius'),
 (2000, 12, 13, 'Sagittarius'),
 (2000, 12, 14, 'Sagittarius'),
 (2000, 12, 15, 'Sagittarius'),
 (2000, 12, 16, 'Sagittarius'),
 (2000, 12, 17, 'Sagittarius'),
 (2000, 12, 18, 'Sagittarius'),
 (2000, 12, 19, 'Sagittarius'),
 (2000, 12, 20, 'Sagittarius'),
 (2000, 12, 21, 'Sagittarius'),
 (2000, 12, 22, 'Capricorn'),
 (2000, 12, 23, 'Capricorn'),
 (2000, 12, 24, 'Capricorn'),
 (2000, 12, 25, 'Capricorn'),
 (2000, 12, 26, 'Capricorn'),
 (2000, 12, 27, 'Capricorn'),
 (2000, 12, 28, 'Capricorn'),
 (2000, 12, 29, 'Capricorn'),
 (2000, 12, 30, 'Capricorn'),
 (2000, 12, 31, 'Capricorn')]
    found_signs = [(year, month, day, get_sign_by_date(signs, datetime(year, month, day))) for year in range(2000, 2001) for month in range(1, 13) for day in sun_cal.itermonthdays(year, month) if day > 0]
    assert found_signs == expected_signs